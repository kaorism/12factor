## V. Build, release, run
### แยกส่วนระหว่างขั้นตอน build และ run อย่างชัดเจน

[โค้ดเบส](./codebase) จะถูกเปลี่ยนมาเป็น การติดตั้ง(non-development)  โดยผ่าน 3 ขั้นตอน(stage):

* *ขั้นตอน build* คือการเปลี่ยนแปลงโดยเปลี่ยงโค้ดภายใน repo ให้อยู่ในรูปของ bundle ที่รันได้ หรือที่รู้จักกันว่า *build*.  ใช้เวอร์ชั่นของโค้ดที่คอมมิต ระบุได้จากโดยการดำเนินการติดตั้ง (deployment) ในขั้นตอน build จะดึง [dependencies](./dependencies) ของ vendor และคอมไพล์ binaries และ assets
* *ขั้นตอน release* จะนำ build ที่ได้จากขั้นตอน build มารวมกับ [คอนฟิก](./config) ของการติดตั้งนั้นๆ   ซึ่งผลลัพท์คือ *release* จะมีทั้ง build และ คอนฟิก และพร้อมจะนำมารันได้ทันทีบน environment ที่ใช้สำหรับรันแอพ
* *ขั้นตอน run* (หรือที่เรียกว่า "runtime") คือการรันแอพใน environment สำหรับรันแอพ โดยการเปิดกลุ่ม [โปรเซส](./processes) ของแอพใน release ที่เลือก

![Code becomes a build, which is combined with config to create a release.](/images/release.png)

**แอพ twelve-factor จะแยกส่วนระหว่างขั้นตอน build และ run อย่างชัดเจน** ยกตัวอย่างเช่น เป็นไปไม่ได้เลยที่จะแก้ไขโค้ดขณะที่รันอยู่เนื่องจากไม่มีทางที่จะนำการแก้ไขนี้กลับไปยังขั้นตอน build

เครื่องมือสำหรับการติดตั้งโดยปกติจะเสนอเครื่องมือสำหรับจัดการ release ความสามารถที่เห็นชัดที่สุดคือ ความสามารถในการ roll back กลับไปยัง release ก่อนหน้าได้  ยกตัวอย่างเช่น [Capistrano](https://github.com/capistrano/capistrano/wiki) เก็บ releases ไว้ใน subdirectory ชื่อว่า `releases`, โดยที่ release ปัจจุบัน จะสร้าง symlink ไปยัง release directory ปัจจุบัน  คำสั่งของ Capistrano `rollback` นั่นทำให้ง่ายที่จะ roll back ไปยัง release ก่อนหน้า

แต่ละ release ควรจะมี ID การ release ที่ต่างกัน, เช่น timestamp ของ release (เช่น `2011-04-06-20:32:17`) หรือ ตัวเลขที่เพิ่มขึ้นเรื่อยๆ  (เช่น `v100`).  releases จะเป็นแบบ append-only เท่านั้นและไม่สามารถเปลี่ยนแปลง(mutated) ได้หลังจากสร้างขึ้นมา ถ้ามีการเปลี่ยนแปลงใดๆ จะต้องสร้าง release ใหม่ขึ้นมา

Build จะเริ่มต้นกระบวนการจากนักพัฒนาแอพ เมื่อต้องการนำโค้ดใหม่ไปติดตั้ง  ในทางตรงกันข้าม การรัน Runtime execution จะสามารถเกิดขึ้นเกิดขึ้นอย่างอัตโนมัติ เช่น การ รีบูตเซอร์เวอร์, หรือโปรเซสที่ค้างอยู่ถูก restart โดย process manager  เพราะฉะนั้นในขั้นตอน run ควรมีความซับซ้อนให้น้อยที่สุด เนื่องจากเมื่อเกิดปัญหาที่ทำให้แอพหยุดการทำงานกลางดึกจะไม่มีนักพัฒนาคอยดูแล  ในส่วนของขั้นตอน build สามารถมีความซับซ้อนได้เนื่องจากหากมีข้อผิดพลาด ก็จะอยู่ในสายตาของนักพัฒนาที่จะทำการติดตั้งแอพ

